import{a as B,c as L,d as $,e as q,f as G,g as z,j as H,k as J,l as K,m as Q,o as X}from"./chunk-AW7BXQV3.js";import{a as j}from"./chunk-CEEY3FZL.js";import{a as F,c as I,f as O,g as R,h as b,m as W,n as P}from"./chunk-YNVE3HA7.js";import{A as T,D as k}from"./chunk-B24WKKOI.js";import{$ as E,D as c,E as u,L as d,M as p,Q as C,S as y,U as i,V as n,X as x,Y as m,Z as U,_ as s,ba as g,ca as h,d as S,da as f,fa as A,r as w,ra as N,ta as D,u as v,x as M,xa as V}from"./chunk-VOBVLZ74.js";var _=class l{constructor(t,e){this.firestore=t;this.auth=e}collectionName="users";addUserWithGeneratedId(t){return S(this,null,function*(){let e=yield k(this.auth,t.email,"password"),r={uid:e.user.uid,email:t.email,role:t.role};yield W(b(this.firestore,`${this.collectionName}/${e.user.uid}`),r)})}updateUserRole(t,e){let r=b(this.firestore,`${this.collectionName}/${t}`);return P(r,{role:e})}deleteUser(t){let e=b(this.firestore,`${this.collectionName}/${t}`);return R(e)}getAllUsers(){let t=O(this.firestore,this.collectionName);return I(t,{idField:"id"})}static \u0275fac=function(e){return new(e||l)(v(F),v(T))};static \u0275prov=w({token:l,factory:l.\u0275fac,providedIn:"root"})};function te(l,t){if(l&1){let e=x();i(0,"tr")(1,"td",18),s(2),n(),i(3,"td",18)(4,"select",20),f("ngModelChange",function(a){let o=c(e).$implicit;return h(o.role,a)||(o.role=a),u(a)}),m("change",function(){let a=c(e).$implicit,o=U();return u(o.updateUserRole(a.uid,a.role))}),i(5,"option",13),s(6,"Admin"),n(),i(7,"option",14),s(8,"Member"),n()()(),i(9,"td",18)(10,"button",21),m("click",function(){let a=c(e).$implicit,o=U();return u(o.deleteUser(a.uid))}),s(11," Delete "),n()()()}if(l&2){let e=t.$implicit;d(2),E(e.email),d(2),g("ngModel",e.role)}}var Y=class l{constructor(t,e,r){this.userService=t;this.authService=e;this.router=r}users=[];newUser={email:"",role:"Member"};ngOnInit(){this.userService.getAllUsers().subscribe(t=>{this.users=t},t=>{console.error("Error fetching users:",t)})}addUser(t){if(t.preventDefault(),this.newUser.email&&this.newUser.role){let e={email:this.newUser.email,role:this.newUser.role};this.userService.addUserWithGeneratedId(e).then(()=>{this.newUser={email:"",role:"Member"}}).catch(r=>{console.error("Error adding user:",r),alert("There was an error adding the user. Please check the console.")})}else alert("Please fill in both email and role fields.")}updateUserRole(t,e){e&&this.userService.updateUserRole(t,e).catch(r=>{console.error("Error updating user role:",r)})}deleteUser(t){this.userService.deleteUser(t).catch(e=>{console.error("Error deleting user:",e)})}goToDashboard(){this.router.navigate(["/admin/dashboard"])}logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||l)(p(_),p(j),p(V))};static \u0275cmp=M({type:l,selectors:[["app-manage-users"]],standalone:!0,features:[A],decls:35,vars:3,consts:[[1,"min-h-screen","bg-gray-100"],[1,"bg-blue-600","text-white","px-6","py-4","flex","justify-between","items-center"],["href","/admin/dashboard",1,"text-2xl","font-bold","hover:underline"],[1,"flex","space-x-4"],[1,"bg-blue-500","px-4","py-2","rounded","hover:bg-blue-700","transition",3,"click"],[1,"bg-red-500","px-4","py-2","rounded","hover:bg-red-600","transition",3,"click"],[1,"p-4"],[1,"mb-6","bg-gray-100","p-4","rounded-md","shadow-md",3,"submit"],[1,"text-lg","font-semibold","mb-4"],[1,"grid","grid-cols-3","gap-4"],["type","email","placeholder","Email","name","email","required","",1,"p-2","border","rounded-md",3,"ngModelChange","ngModel"],["name","role","required","",1,"p-2","border","rounded-md",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],["value","Admin"],["value","Member"],["type","submit",1,"bg-blue-500","text-white","p-2","rounded-md","hover:bg-blue-600"],[1,"w-full","border-collapse","border","border-gray-200"],[1,"bg-gray-100"],[1,"border","p-2"],[4,"ngFor","ngForOf"],[1,"p-2","border","rounded-md",3,"ngModelChange","change","ngModel"],[1,"bg-red-500","text-white","p-1","rounded-md","hover:bg-red-600",3,"click"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"nav",1)(2,"a",2),s(3," TaskManagePortal "),n(),i(4,"div",3)(5,"button",4),m("click",function(){return r.goToDashboard()}),s(6," Back to Dashboard "),n(),i(7,"button",5),m("click",function(){return r.logout()}),s(8," Logout "),n()()(),i(9,"div",6)(10,"form",7),m("submit",function(o){return r.addUser(o)}),i(11,"h2",8),s(12,"Add New User"),n(),i(13,"div",9)(14,"input",10),f("ngModelChange",function(o){return h(r.newUser.email,o)||(r.newUser.email=o),o}),n(),i(15,"select",11),f("ngModelChange",function(o){return h(r.newUser.role,o)||(r.newUser.role=o),o}),i(16,"option",12),s(17,"Select Role"),n(),i(18,"option",13),s(19,"Admin"),n(),i(20,"option",14),s(21,"Member"),n()(),i(22,"button",15),s(23," Add User "),n()()(),i(24,"table",16)(25,"thead")(26,"tr",17)(27,"th",18),s(28,"Email"),n(),i(29,"th",18),s(30,"Role"),n(),i(31,"th",18),s(32,"Actions"),n()()(),i(33,"tbody"),C(34,te,12,2,"tr",19),n()()()()),e&2&&(d(14),g("ngModel",r.newUser.email),d(),g("ngModel",r.newUser.role),d(19),y("ngForOf",r.users))},dependencies:[X,z,J,K,B,H,L,$,Q,G,q,D,N],encapsulation:2})};export{Y as ManageUsersComponent};
