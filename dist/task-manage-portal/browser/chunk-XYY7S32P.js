import{a as L,b as d,c as M,d as k,g as N,h as T,i as R,m as q,n as j,o as A,p as V}from"./chunk-AW7BXQV3.js";import{a as E}from"./chunk-CEEY3FZL.js";import"./chunk-YNVE3HA7.js";import"./chunk-B24WKKOI.js";import{D as w,E as y,L as a,M as g,Q as p,S as c,U as r,V as o,W as f,X as S,Y as b,Z as h,_ as n,aa as m,d as v,fa as _,sa as C,ta as F,x,xa as I}from"./chunk-VOBVLZ74.js";function G(s,i){s&1&&(r(0,"div",6)(1,"label",18),n(2," Username "),o(),f(3,"input",19),o())}function P(s,i){if(s&1&&(r(0,"div",20),n(1),o()),s&2){let t=h();a(),m(" ",t.errorMessage," ")}}function U(s,i){if(s&1){let t=S();r(0,"a",21),b("click",function(){w(t);let l=h();return y(l.navigateToForgotPassword())}),n(1," Forgot Password? "),o()}}var D=class s{constructor(i,t,e){this.fb=i;this.authService=t;this.router=e;this.loginForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]],username:[""]})}loginForm;mode=!1;errorMessage="";onSubmit(){return v(this,null,function*(){if(this.errorMessage="",!this.loginForm.valid){this.errorMessage="Please fill in all required fields.";return}let{email:i,password:t,username:e}=this.loginForm.value;console.log("Form submitted with:",i,t,e);try{if(this.mode){console.log("Registering user:",i,e),yield this.authService.registerUser(i,t),console.log("Automatically logging in user after registration."),yield this.authService.login(i,t);let u=this.authService.getLoggedInUser().role?.toLowerCase();u==="admin"?this.router.navigate(["/admin/dashboard"]):u==="member"&&this.router.navigate(["/member/member-dashboard"])}else{console.log("Logging in user:",i),yield this.authService.login(i,t);let u=this.authService.getLoggedInUser().role?.toLowerCase();u==="admin"?this.router.navigate(["/admin/dashboard"]):u==="member"&&this.router.navigate(["/member/member-dashboard"])}}catch(l){console.error("Error during form submission:",l),this.errorMessage=l.message||"An error occurred."}})}toggleMode(){this.mode=!this.mode,this.errorMessage="",this.mode?this.loginForm.addControl("username",this.fb.control("",[d.required])):this.loginForm.removeControl("username")}navigateToForgotPassword(){this.router.navigate(["/forget-password"])}static \u0275fac=function(t){return new(t||s)(g(j),g(E),g(I))};static \u0275cmp=x({type:s,selectors:[["app-login"]],standalone:!0,features:[_],decls:27,vars:8,consts:[[1,"bg-blue-600","text-white","px-6","py-4"],[1,"text-4xl","font-bold","text-center"],[1,"flex","items-center","justify-center","min-h-screen","bg-blue-100"],[1,"w-full","max-w-md","bg-white","rounded-lg","shadow-lg","p-6"],[1,"text-3xl","font-bold","text-center","mb-6"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","email",1,"block","text-sm","font-medium","text-gray-700"],["id","email","type","email","formControlName","email","placeholder","Enter your email","required","",1,"w-full","mt-1","px-3","py-2","border","rounded-lg","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500"],["class","mb-4",4,"ngIf"],["for","password",1,"block","text-sm","font-medium","text-gray-700"],["id","password","type","password","formControlName","password","placeholder","Enter your password","required","",1,"w-full","mt-1","px-3","py-2","border","rounded-lg","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500"],["class","mb-4 text-red-600 text-sm",4,"ngIf"],[1,"flex","justify-between","items-center","mb-4"],["href","javascript:void(0)","class","text-sm text-blue-500 hover:underline ml-auto",3,"click",4,"ngIf"],["type","submit",1,"w-full","px-4","py-2","bg-blue-500","text-white","rounded-lg","shadow-md","hover:bg-blue-600","transition-colors"],[1,"text-sm","text-center"],["type","button",1,"text-blue-500","hover:underline",3,"click"],["for","username",1,"block","text-sm","font-medium","text-gray-700"],["id","username","type","text","formControlName","username","placeholder","Enter your username","required","",1,"w-full","mt-1","px-3","py-2","border","rounded-lg","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500"],[1,"mb-4","text-red-600","text-sm"],["href","javascript:void(0)",1,"text-sm","text-blue-500","hover:underline","ml-auto",3,"click"]],template:function(t,e){t&1&&(r(0,"nav",0)(1,"h1",1),n(2,"TaskManagePortal"),o()(),r(3,"div",2)(4,"div",3)(5,"h2",4),n(6),o(),r(7,"form",5),b("ngSubmit",function(){return e.onSubmit()}),r(8,"div",6)(9,"label",7),n(10," Email "),o(),f(11,"input",8),o(),p(12,G,4,0,"div",9),r(13,"div",6)(14,"label",10),n(15," Password "),o(),f(16,"input",11),o(),p(17,P,2,1,"div",12),r(18,"div",13),p(19,U,2,0,"a",14),o(),r(20,"div",13)(21,"button",15),n(22),o()(),r(23,"p",16),n(24),r(25,"button",17),b("click",function(){return e.toggleMode()}),n(26),o()()()()()),t&2&&(a(6),m(" ",e.mode?"Register":"Login"," "),a(),c("formGroup",e.loginForm),a(5),c("ngIf",e.mode),a(5),c("ngIf",e.errorMessage),a(2),c("ngIf",!e.mode),a(3),m(" ",e.mode?"Register":"Login"," "),a(2),m(" ",e.mode?"Already have an account?":"Don't have an account?"," "),a(2),m(" ",e.mode?"Login":"Register"," "))},dependencies:[A,N,L,M,k,q,F,C,V,T,R],encapsulation:2})};export{D as LoginComponent};
